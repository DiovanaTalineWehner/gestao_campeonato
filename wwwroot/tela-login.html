<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="tela-login.css">
    <script src="Verificação.js"></script>
    <title>Document</title>
</head>
<body>
<div class="main-login">
    <div class="left-login">
            <h1> Faça login<br> E entre para nossa equipe</h1></div>
    <div class="right-login">
            <div class="card-login">
                    <h1>LOGIN</h1>
                      <div class="textfield">
                      <label for="usuario">Usuário</label>
                      <input type="text" id="usuario" name="usuario" placeholder="Usuario">
                      </div>
                         <div class="textfield">
                         <label for="senha">Senha</label>
                         <input type="password" id="senha" name="senha" placeholder="Senha">
                         </div>
                <button class="btn-login" onclick="DadosLogin()">Login</button>
                <button class="btn-criar-conta" id="btn-criar-conta">Criar conta</button>

            </div>
    </div>

</div>
<!--Ao clicar no botão criar conta vai direcionada para página de Criarconta.html-->
<script> 
    console.log("Script carregado"); 

    var btnCriarConta = document.getElementById("btn-criar-conta");

    btnCriarConta.addEventListener("click", function() {
        console.log("Botão Criar conta clicado");
        window.open("Criarconta.html");
    });
</script>


<!-- Autenticação dos dados de cadastro, observação só vai conseguir fazer o login se tiver cadastrado uma conta-->
</body>
</html>
<!--<script>
    function LogarUsuario() {
        debugger
        var url = "http://localhost:5000/api/usuario/login";

        var email = document.getElementById('usuario').value;
        var senha = document.getElementById('senha').value;

        if (email == null || email == "") {
            alert("Informe um E-mail!");
            return;
        }
        if (senha == null || senha == "") {
            alert("Informe uma Senha!");
            return;
        }

        var request = new XMLHttpRequest();
        request.open("POST", url);
        request.setRequestHeader("Content-Type", "application/json");
        request.send(JSON.stringify({ "UserName": email, "Password": senha }));

        request.onreadystatechange = function(){
            if (request.readyState == 4 && request.status == 200 ) {
                alert("Usuário Logado!");
            } else {
                alert("Usuário ou Senha incorreto!");
            }
        }
    }
    </script>
-->

<script>


    function DadosLogin(email, senha) {

    var email = document.getElementById('usuario').value;
    var senha = document.getElementById('senha').value;

    if (email == null || email == "") {
        alert("Informe um E-mail!");
        return;
    }
    if (senha == null || senha == "") {
        alert("Informe uma Senha!");
        return;
    }

     var dadoslogin = {
       UserName: email,
       Password: senha
     };
   
     fetch('http://localhost:5000/api/usuario/login', {
        method: 'POST',
        credentials:'same-origin',
        headers: {
         'Content-Type': 'application/json'
       },
       body: JSON.stringify(dadoslogin)
     })
     .then(function(response) {
        debugger
       if (response.ok) {
        window.location.replace("http://localhost:5000/sistemastr.html");
        //var cookieRecebido = "Token";
        //document.cookie = token=cookieRecebido;
       // localStorage.setItem("Token");
    } else {
       alert("Email ou senha incorreto")
       }
     })
     .catch(function(error) {
       alert("Erro na conexão. ") 
         });
   }
   </script>
   